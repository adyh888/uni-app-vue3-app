import {AxiosEnv, Mc} from '../../src/main'
import axios from "axios";
import {Ac} from "../../src/main";
import {AuthData} from "../../src/ms/mc";
import {
    AlarmDeleteProperty,
    AlarmInsertProperty,
    AlarmSelectProperty,
    AlarmUpdateProperty,
    FeedbackInsertProperty, FeedbackUpdateProperty, TaskInsertProperty, TaskUpdateProperty
} from "../../src/ms/ac";


const baseURL = 'https://api.mew-iot.cn'
let service = axios.create({
    baseURL ,
    // adapter: axiosAdapterUniapp as AxiosAdapter,
    timeout: 10000
})
let authData:AuthData
let ac

describe('ac',()=>{

    beforeEach(async () => {
        const mc = Mc(service)
        const res = await mc.getAuth({username: 'admin', password: '111111'})
        authData = res.data
        const access_token = authData.access_token
        service = axios.create({
            baseURL,
            // adapter: axiosAdapterUniapp as AxiosAdapter,
            timeout: 10000,
            headers:{
                'Authorization': 'Bearer ' + access_token
            }
        })
        ac = Ac(service)
    })

    test('查询ac版本号', async () => {
        const res = await ac.getVersion()
        // console.log(res)
        expect(res.code).toBe(0)
        expect(res.msg).toBe('success')
        expect(res.data).not.toBe('')
    }, 2000)
    // const deviceId='052003001'
    // test('根据androidId获取设备信息', async() => {
    //     const res = await dc.device.find({id:deviceId})
    //     console.log(res)
    //     expect(res.data[0].id).toBe(deviceId)
    // },2000)

    // test('alarm插入数据', async() => {
    //     const res = await ac.alarm.insert({
    //         alarmLength: 0,
    //         alarmTime: new Date(),
    //         enabled: false,
    //         timespan: 0,
    //         id:2,type:'xxx',name:'aaa', grade:'bbb', describe:'ccc'})
    //     // console.log(res)
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('success')
    //     // // 第一个用户名必须为admin
    //     // expect(res.data[0].username).toBe('admin')
    // },2000)

    const id = 1

    const phoneNo = 15895035525
    const deviceId = '022111001'

    // test('message_notice短信通知',async () => {
    //     const res = await ac.message.messsge_notice({phoneNo})
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('发送成功')
    // },2000)

    ///dc/verification/password已实现发送验证码功能，此处可省略
    // test('verificationCode租用密码',async () => {
    //     const res = await ac.message.verificationCode(json)
    //
    // },2000)
    //
    // test('verificationCode/normal通知快递',async () => {
    //     const res = await ac.message.verificationCode.normal(json1)
    // },2000)

    // test('dingtalk钉钉',async () => {
    //     const json = {isNull: true}
    //     const res = await ac.dingtalk.cheeck_url(json)
    // },2000)
})
