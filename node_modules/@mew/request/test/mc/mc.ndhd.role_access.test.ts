import axios from "axios";
import {Mc} from "../../src/ms/mc";

const service = axios.create({
    baseURL: 'https://api.mew-iot.cn',
    // adapter: axiosAdapterUniapp as AxiosAdapter,
    timeout: 10000
})
const mc = Mc(service)

function testRoleAccess(roleId:number,accessId:number){
    describe('role_access',()=>{
        beforeAll(async () => {
            const res = await mc.role_access.select({roleId,accessId})
            if (res.total === 0) {
                await mc.role_access.insert({
                    roleId: roleId,
                    accessId: accessId,
                    enabled: true,
                })
            }
        })
        test(`role_access中包含roleId:${roleId},accessId:${accessId}`, async() => {
            const res = await mc.role_access.select({roleId,accessId})
            // console.log(res)
            expect(res.code).toBe(0)
            expect(res.msg).toBe('success')
            expect(res.data[0].roleId).toBe(roleId)
            expect(res.data[0].accessId).toBe(accessId)
            expect(res.data[0].enabled).toBe(true)
        },2000)
    })
}

// roleId=11 为 ndhd_admin
testRoleAccess(11,1)
testRoleAccess(11,21)
testRoleAccess(11,23)
testRoleAccess(11,258)
testRoleAccess(11,2)
testRoleAccess(11,238)
testRoleAccess(11,239)
testRoleAccess(11,240)
testRoleAccess(11,3)
testRoleAccess(11,32)
testRoleAccess(11,34)
testRoleAccess(11,35)
