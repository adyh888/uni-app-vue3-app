import {Mc} from '../../src/main'
import axios from "axios";
const service = axios.create({
    baseURL: 'https://api.mew-iot.cn',
    // adapter: axiosAdapterUniapp as AxiosAdapter,
    timeout: 10000
})
const mc = Mc(service)

const appId = '5000000002334316' // 钉钉企业第三方应用-智能配发柜

describe('app',()=>{
    beforeAll(async()=>{

    })
    test('app select', async() => {
        const res = await mc.app.select({id: appId})
        // console.log(res)
        expect(res.code).toBe(0)
        expect(res.msg).toBe('success')
    },2000)

    test('app /mc/app/getAccessToken', async() => {
        const res = await mc.getAccessToken(appId)
        // console.log(res)
        expect(res.code).toBe(0)
        expect(res.msg).toBe('success')
        expect(res.data.expireIn).toBe(7200)
        expect(res.data.expireAt).toBeGreaterThan(0)
        expect(res.data.accessToken).not.toBe('')
    },2000)
})

describe('role_access',()=>{
    beforeAll(async()=>{

    })

    test('app /mc/app/updateBatch', async() => {
        const mc = Mc(service)
        const json = {roleId: 19, accessIdArr:[1, 21, 23, 212, 219, 258, 259] }
        const res = await mc.updateRoleAccessBatch(json)
        console.log(res)
        expect(res.code).toBe(0)
        expect(res.msg).toBe('success')
        // expect(res.data.expireIn).toBe(7200)
        // expect(res.data.expireAt).toBeGreaterThan(0)
        // expect(res.data.accessToken).not.toBe('')
    },2000)

    test('app /mc/app/getAppUserInfo', async() => {
        const mc = Mc(service)
        const json = {appId:"5000000002334316",code:"dab8ae40affc3befa57030dae13828ac" }
        const res = await mc.getAppUserInfo(json)
        console.log(res)
        expect(res.code).toBe(0)
        expect(res.msg).toBe('success')
        // expect(res.data.expireIn).toBe(7200)
        // expect(res.data.expireAt).toBeGreaterThan(0)
        // expect(res.data.accessToken).not.toBe('')
    },2000)

})
