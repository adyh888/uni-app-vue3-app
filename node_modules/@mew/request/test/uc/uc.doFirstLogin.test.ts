import axios from "axios";
import {AuthData, Mc} from "../../src/ms/mc";
import {Tc} from "../../src/ms/tc";

// const baseURL = 'http://www.mew-iot.cn:51000'
const baseURL = 'https://api.mew-iot.cn'

let service = axios.create({
    baseURL ,
    // adapter: axiosAdapterUniapp as AxiosAdapter,
    timeout: 10000
})
let authData:AuthData
let uc

describe('uc', () => {
    beforeAll(async () => {
        const mc = Mc(service)
        const res = await mc.getAuth({username: 'admin', password: '111111'})
        authData = res.data
        const access_token = authData.access_token
        service = axios.create({
            baseURL,
            // adapter: axiosAdapterUniapp as AxiosAdapter,
            timeout: 10000,
            headers:{
                'Authorization': 'Bearer ' + access_token
            }
        })
        uc = Tc(service)
    })
    const id=1, deviceId='022111001'

    // test('设备号首次登录',async () => {
    //
    //     const res = await uc.doFirstLogin.deviceUser({username: 'admin', deviceId, roleId: 1 })
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('success')
    //     expect(res.data.length).toBe(1)
    //     expect(res.data[0].username).toBe('admin')
    //     expect(res.data[0].deviceId).toBe('022111001')
    //     expect(res.data[0].roleId).toBe(1)
    // },2000)
    //
    // test('人脸首次登录',async () => {
    //
    //     const res = await uc.doFirstLogin.face({id, uid: 1, featureData: '1647952611192', deviceId, status: true, roleId: 1})
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('success')
    //     expect(res.data.length).toBe(1)
    //     expect(res.data[0].uid).toBe(1)
    //     expect(res.data[0].featureData).toBe('1647952611192')
    //     expect(res.data[0].deviceId).toBe('022111001')
    //     expect(res.data[0].status).toBe(true)
    // },2000)
    //
    // test('指纹首次登录',async () => {
    //
    //     const res = await uc.doFirstLogin.finger({uid: 1, no: 1, deviceId, fingerprint: '1647953368448'})
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('success')
    //     expect(res.data.length).toBe(1)
    //     expect(res.data[0].uid).toBe(1)
    //     expect(res.data[0].no).toBe(1)
    //     expect(res.data[0].deviceId).toBe('022111001')
    //     expect(res.data[0].fingerprint).toBe('1647953368448')
    // },2000)
    //
    // test('刷卡首次登录',async () => {
    //
    //     const res = await uc.doFirstLogin.card({cardNo: '2882711915', deviceId})
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('success')
    //     expect(res.data.length).toBe(1)
    //     expect(res.data[0].cardNo).toBe('2882711915')
    //     expect(res.data[0].deviceId).toBe('022111001')
    // },2000)
})
