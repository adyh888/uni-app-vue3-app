import {Mc, Tc} from '../../src/main'
import {AuthData} from "../../src/ms/mc";
import {} from "../../src/ms/uc";
import axios from "axios";

// const baseURL = 'http://www.mew-iot.cn:51000'
const baseURL = 'https://api.mew-iot.cn'

let service = axios.create({
    baseURL ,
    // adapter: axiosAdapterUniapp as AxiosAdapter,
    timeout: 10000
})
let authData:AuthData
let uc
describe('uc', () => {
    beforeAll(async () => {
        const mc = Mc(service)
        const res = await mc.getAuth({username: 'admin', password: '111111'})
        authData = res.data
        const access_token = authData.access_token
        service = axios.create({
            baseURL,
            // adapter: axiosAdapterUniapp as AxiosAdapter,
            timeout: 10000,
            headers:{
                'Authorization': 'Bearer ' + access_token
            }
        })
        uc = Tc(service)
    })

    const id=1

    // test('role_access表删除id=2的角色',async () => {
    //
    //     const res = await uc.role_access.delete({id: 2})
    //     expect(res.code).toBe(0)
    //     expect(res.msg).toBe('success')
    //     expect(res.data.length).toBeGreaterThanOrEqual(0)
    // })
    //
    // test('role_access表创建角色对应模块的权限',async () => {
    //
    //     async function insertData(json:RoleAccessInsertProperty) {
    //     const res = await uc.role_access.insert(json)
    //         expect(res.code).toBe(0)
    //         expect(res.msg).toBe('success')
    //         expect(res.data.length).toBe(1)
    //         let role_access = res.data[0]
    //         expect(role_access.companyId).toBe(json.companyId)
    //         expect(role_access.status).toBe(json.status)
    //         expect(role_access.name).toBe(json.name)
    //         expect(role_access.description).toBe(json.description)
    //     }
    //     const res =await uc.role_access.select({pageSize: 1, curPageNo: 1})
    //     if (res.data.length == 0){
    //         await insertData({id, roleId: 1, accessId: 1})
    //         await insertData({id: 2, roleId: 2, accessId: 2})
    //     }
    // })
})
