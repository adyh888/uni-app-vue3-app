import {
    ContentItem, DbReader, DbWriter,
    getDbJob, getDbJobs,
    getDbReader,
    GetDbReaderProperty,
    getDbWriter,
    GetDbWriterProperty,
    writeToFile
} from "../../src/db/db";


describe('db.test', () => {
    test('getDbJob',async () => {
        const readerProperty:GetDbReaderProperty = {
            host:'www.mew-iot.cn',
            port: 50281,
            username: 'root',
            password: 'booher2018',
            dbName: 'mc',
            tableName: 'access',
            column: ['*'],
            where: 'id > 0'
        }
        const writerProperty: GetDbWriterProperty ={
            host:'www.mew-iot.cn',
            port: 51081,
            username: 'root',
            password: 'booher2018',
            writeMode: 'replace',
            dbName: 'mc',
            tableName: 'access',
            column: ['*']
        }
        const json = getDbJob(readerProperty,writerProperty)
        writeToFile('./src/db/json/getDbJob.json',json)
    },2000)

    test('getDbJobs',async () => {
        const content:ContentItem[] = [
            {
                reader: getDbReader({
                    host:'www.mew-iot.cn',
                    port: 50281,
                    username: 'root',
                    password: 'booher2018',
                    dbName: 'uc',
                    tableName: 'user',
                    column: ['id','name']
                }),
                writer: getDbWriter({
                    host:'www.mew-iot.cn',
                    port: 50281,
                    username: 'root',
                    password: 'booher2018',
                    writeMode: 'replace',
                    dbName: 'uc',
                    tableName: 'user',
                    column: ['id','name']
                })
            },
            {
                reader: getDbReader({
                    host:'www.mew-iot.cn',
                    port: 50281,
                    username: 'root',
                    password: 'booher2018',
                    dbName: 'uc',
                    tableName: 'device_user',
                    column: ['id','name']
                }),
                writer: getDbWriter({
                    host:'www.mew-iot.cn',
                    port: 50281,
                    username: 'root',
                    password: 'booher2018',
                    writeMode: 'replace',
                    dbName: 'uc',
                    tableName: 'device_user',
                    column: ['id','name']
                })
            },
        ]
        const json = getDbJobs(content)
        writeToFile('./src/db/json/getDbJob.json',json)
    },2000)
})
